"use strict";var h=Object.create;var n=Object.defineProperty;var l=Object.getOwnPropertyDescriptor;var u=Object.getOwnPropertyNames;var E=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var y=(s,r)=>{for(var e in r)n(s,e,{get:r[e],enumerable:!0})},p=(s,r,e,t)=>{if(r&&typeof r=="object"||typeof r=="function")for(let o of u(r))!m.call(s,o)&&o!==e&&n(s,o,{get:()=>r[o],enumerable:!(t=l(r,o))||t.enumerable});return s};var U=(s,r,e)=>(e=s!=null?h(E(s)):{},p(r||!s||!s.__esModule?n(e,"default",{value:s,enumerable:!0}):e,s)),v=s=>p(n({},"__esModule",{value:!0}),s);var P={};y(P,{VerifyEmail:()=>d});module.exports=v(P);var i=U(require("jsonwebtoken")),a=class{constructor(r){this.showUserPerUserIdRepository=r}async validAuth(r){let[,e]=r.split(" ");if(!i.default.verify(e,process.env.TOKEN_SECRET??""))throw Error("Invalid token");let{id:o,email:w}=i.default.verify(e,process.env.TOKEN_SECRET??""),I=await this.showUserPerUserIdRepository?.show(o);if(w!==I?.email)throw Error("Invalid token");return o}async authentication(r,e){if(!await r.comparePasswords(e))throw Error("Invalid password");return i.default.sign({id:r.userId,email:r.userEmail},process.env.TOKEN_SECRET??"",{expiresIn:process.env.TOKEN_EXPIRATION})}async authenticationProvider(r,e){return i.default.sign({id:r,email:e},process.env.TOKEN_SECRET??"",{expiresIn:process.env.TOKEN_EXPIRATION})}},c=a;var d=class{constructor(r){this.showUserPerIdRepository=r}async execute(r){let t=await new c(this.showUserPerIdRepository).validAuth(r);return!!await this.showUserPerIdRepository.show(t)}};0&&(module.exports={VerifyEmail});
