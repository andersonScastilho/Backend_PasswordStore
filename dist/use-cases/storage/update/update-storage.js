"use strict";var S=Object.create;var a=Object.defineProperty;var w=Object.getOwnPropertyDescriptor;var y=Object.getOwnPropertyNames;var m=Object.getPrototypeOf,l=Object.prototype.hasOwnProperty;var x=(r,t)=>{for(var o in t)a(r,o,{get:t[o],enumerable:!0})},u=(r,t,o,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let e of y(t))!l.call(r,e)&&e!==o&&a(r,e,{get:()=>t[e],enumerable:!(s=w(t,e))||s.enumerable});return r};var v=(r,t,o)=>(o=r!=null?S(m(r)):{},u(t||!r||!r.__esModule?a(o,"default",{value:r,enumerable:!0}):o,r)),R=r=>u(a({},"__esModule",{value:!0}),r);var B={};x(B,{UpdateStorage:()=>c});module.exports=R(B);var p=v(require("crypto")),I="aes-256-gcm",P=Buffer.from(process.env.SECRET_CRYPTO??"","hex"),C=p.default.randomBytes(16);var h=r=>{try{let t=p.default.createDecipheriv(I,P,Buffer.from(r.iv,"hex"));t.setAuthTag(Buffer.from(r.tag,"hex"));let o=Buffer.from(r.content,"hex");return Buffer.concat([t.update(o),t.final()]).toString("utf8")}catch{throw new Error("Erro ao descriptografar os dados.")}};var i=class{get storageId(){return this.props.storageId}get password(){return this.props.password}get account(){return this.props.account}get usageLocation(){return this.props.usageLocation}get link(){return this.props.link}get description(){return this.props.description}get userId(){return this.props.userId}set updatePassword(t){this.props.password=t}constructor(t){this.props=t}showPassword(t){let[o,s,e]=t.split(":");return h({iv:o,content:s,tag:e})}};var c=class{constructor(t,o){this.updateStorageReposirory=t;this.showStorageRepository=o}async execute({storageId:t,account:o,description:s,link:e,usageLocation:g,userId:d,password:f}){if(!await this.showStorageRepository.show(t,d))throw Error("Storage not found");let n=await this.updateStorageReposirory.update({storageId:t,account:o,userId:d,description:s,link:e,usageLocation:g,password:f});return new i({account:n.account,password:"",storageId:n.id,usageLocation:n.usageLocation,userId:n.userId,description:n.description||"",link:n.link||""})}};0&&(module.exports={UpdateStorage});
