"use strict";var P=Object.create;var n=Object.defineProperty;var I=Object.getOwnPropertyDescriptor;var B=Object.getOwnPropertyNames;var E=Object.getPrototypeOf,k=Object.prototype.hasOwnProperty;var L=(r,t)=>{for(var e in t)n(r,e,{get:t[e],enumerable:!0})},d=(r,t,e,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of B(t))!k.call(r,s)&&s!==e&&n(r,s,{get:()=>t[s],enumerable:!(o=I(t,s))||o.enumerable});return r};var T=(r,t,e)=>(e=r!=null?P(E(r)):{},d(t||!r||!r.__esModule?n(e,"default",{value:r,enumerable:!0}):e,r)),$=r=>d(n({},"__esModule",{value:!0}),r);var q={};L(q,{CreateStorage:()=>p});module.exports=$(q);var w=require("uuid");var i=T(require("crypto")),f="aes-256-gcm",h=Buffer.from(process.env.SECRET_CRYPTO??"","hex"),u=i.default.randomBytes(16),m=r=>{try{let t=i.default.createCipheriv(f,h,u),e=Buffer.concat([t.update(r.toString()),t.final()]),o=t.getAuthTag();return{iv:u.toString("hex"),content:e.toString("hex"),tag:o.toString("hex")}}catch{throw Error("Erro ao criptografar os dados")}},y=r=>{try{let t=i.default.createDecipheriv(f,h,Buffer.from(r.iv,"hex"));t.setAuthTag(Buffer.from(r.tag,"hex"));let e=Buffer.from(r.content,"hex");return Buffer.concat([t.update(e),t.final()]).toString("utf8")}catch{throw new Error("Erro ao descriptografar os dados.")}};var a=class{get storageId(){return this.props.storageId}get password(){return this.props.password}get account(){return this.props.account}get usageLocation(){return this.props.usageLocation}get link(){return this.props.link}get description(){return this.props.description}get userId(){return this.props.userId}set updatePassword(t){this.props.password=t}constructor(t){this.props=t}showPassword(t){let[e,o,s]=t.split(":");return y({iv:e,content:o,tag:s})}};var p=class{constructor(t){this.storageRepository=t}async execute({account:t,password:e,usageLocation:o,description:s,link:g,userId:S}){let v=(0,w.v4)(),{iv:x,content:l,tag:R}=m(e),C=`${x}:${l}:${R}`,c=new a({password:C,account:t,usageLocation:o,description:s,link:g,userId:S,storageId:v});return await this.storageRepository.create(c),c.updatePassword="",c}};0&&(module.exports={CreateStorage});
