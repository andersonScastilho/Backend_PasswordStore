"use strict";var l=Object.create;var n=Object.defineProperty;var x=Object.getOwnPropertyDescriptor;var I=Object.getOwnPropertyNames;var R=Object.getPrototypeOf,v=Object.prototype.hasOwnProperty;var P=(r,t)=>{for(var o in t)n(r,o,{get:t[o],enumerable:!0})},h=(r,t,o,e)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of I(t))!v.call(r,s)&&s!==o&&n(r,s,{get:()=>t[s],enumerable:!(e=x(t,s))||e.enumerable});return r};var B=(r,t,o)=>(o=r!=null?l(R(r)):{},h(t||!r||!r.__esModule?n(o,"default",{value:r,enumerable:!0}):o,r)),E=r=>h(n({},"__esModule",{value:!0}),r);var T={};P(T,{ShowStorageController:()=>u});module.exports=E(T);var m=require("@prisma/client"),f=new m.PrismaClient;var i=class{async show(t,o){return await f.storage.findFirst({where:{AND:{id:t,userId:o}}})}};var g=B(require("crypto")),C="aes-256-gcm",k=Buffer.from(process.env.SECRET_CRYPTO??"","hex"),D=g.default.randomBytes(16);var w=r=>{try{let t=g.default.createDecipheriv(C,k,Buffer.from(r.iv,"hex"));t.setAuthTag(Buffer.from(r.tag,"hex"));let o=Buffer.from(r.content,"hex");return Buffer.concat([t.update(o),t.final()]).toString("utf8")}catch{throw new Error("Erro ao descriptografar os dados.")}};var a=class{get storageId(){return this.props.storageId}get password(){return this.props.password}get account(){return this.props.account}get usageLocation(){return this.props.usageLocation}get link(){return this.props.link}get description(){return this.props.description}get userId(){return this.props.userId}set updatePassword(t){this.props.password=t}constructor(t){this.props=t}showPassword(t){let[o,e,s]=t.split(":");return w({iv:o,content:e,tag:s})}};var c=class{constructor(t){this.showStorageRepository=t}async execute(t,o){let e=await this.showStorageRepository.show(t,o);if(!e)throw Error("Storage not found");return new a({account:e.account,password:"",storageId:e.id,usageLocation:e.usageLocation,userId:e.userId,description:e.description||"",link:e.link||""})}};var p=require("zod"),L=p.z.object({storageId:p.z.string(),userId:p.z.string()}),u=class{async handle(t,o,e){try{let{storageId:s,userId:d}=L.parse(t.params),S=new i,y=await new c(S).execute(s,d);return o.status(200).json(y)}catch(s){e(s)}}};0&&(module.exports={ShowStorageController});
