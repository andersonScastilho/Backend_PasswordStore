"use strict";var u=Object.create;var n=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var f=Object.getPrototypeOf,w=Object.prototype.hasOwnProperty;var y=(r,t)=>{for(var o in t)n(r,o,{get:t[o],enumerable:!0})},p=(r,t,o,e)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of h(t))!w.call(r,s)&&s!==o&&n(r,s,{get:()=>t[s],enumerable:!(e=d(t,s))||e.enumerable});return r};var S=(r,t,o)=>(o=r!=null?u(f(r)):{},p(t||!r||!r.__esModule?n(o,"default",{value:r,enumerable:!0}):o,r)),m=r=>p(n({},"__esModule",{value:!0}),r);var v={};y(v,{ShowStorage:()=>a});module.exports=m(v);var c=S(require("crypto")),x="aes-256-gcm",l=Buffer.from(process.env.SECRET_CRYPTO??"","hex"),E=c.default.randomBytes(16);var g=r=>{try{let t=c.default.createDecipheriv(x,l,Buffer.from(r.iv,"hex"));t.setAuthTag(Buffer.from(r.tag,"hex"));let o=Buffer.from(r.content,"hex");return Buffer.concat([t.update(o),t.final()]).toString("utf8")}catch{throw new Error("Erro ao descriptografar os dados.")}};var i=class{get storageId(){return this.props.storageId}get password(){return this.props.password}get account(){return this.props.account}get usageLocation(){return this.props.usageLocation}get link(){return this.props.link}get description(){return this.props.description}get userId(){return this.props.userId}set updatePassword(t){this.props.password=t}constructor(t){this.props=t}showPassword(t){let[o,e,s]=t.split(":");return g({iv:o,content:e,tag:s})}};var a=class{constructor(t){this.showStorageRepository=t}async execute(t,o){let e=await this.showStorageRepository.show(t,o);if(!e)throw Error("Storage not found");return new i({account:e.account,password:"",storageId:e.id,usageLocation:e.usageLocation,userId:e.userId,description:e.description||"",link:e.link||""})}};0&&(module.exports={ShowStorage});
