"use strict";var E=Object.create;var n=Object.defineProperty;var l=Object.getOwnPropertyDescriptor;var I=Object.getOwnPropertyNames;var w=Object.getPrototypeOf,m=Object.prototype.hasOwnProperty;var v=(s,r)=>{for(var e in r)n(s,e,{get:r[e],enumerable:!0})},d=(s,r,e,t)=>{if(r&&typeof r=="object"||typeof r=="function")for(let o of I(r))!m.call(s,o)&&o!==e&&n(s,o,{get:()=>r[o],enumerable:!(t=l(r,o))||t.enumerable});return s};var y=(s,r,e)=>(e=s!=null?E(w(s)):{},d(r||!s||!s.__esModule?n(e,"default",{value:s,enumerable:!0}):e,s)),T=s=>d(n({},"__esModule",{value:!0}),s);var P={};v(P,{default:()=>h});module.exports=T(P);var i=y(require("jsonwebtoken")),a=class{constructor(r){this.showUserPerUserIdRepository=r}async validAuth(r){let[,e]=r.split(" ");if(!i.default.verify(e,process.env.TOKEN_SECRET??""))throw Error("Invalid token");let{id:o,email:p}=i.default.verify(e,process.env.TOKEN_SECRET??""),c=await this.showUserPerUserIdRepository?.show(o);if(p!==c?.email)throw Error("Invalid token");return o}async authentication(r,e){if(!await r.comparePasswords(e))throw Error("Invalid password");return i.default.sign({id:r.userId,email:r.userEmail},process.env.TOKEN_SECRET??"",{expiresIn:process.env.TOKEN_EXPIRATION})}async authenticationProvider(r,e){return i.default.sign({id:r,email:e},process.env.TOKEN_SECRET??"",{expiresIn:process.env.TOKEN_EXPIRATION})}},h=a;
